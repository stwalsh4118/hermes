# Hermes Virtual TV Channel Service - Configuration File
# Copy this file to config.yaml and customize for your environment
#
# All settings can also be set via environment variables with the HERMES_ prefix
# Example: HERMES_SERVER_PORT=9090 overrides server.port
#
# Priority order (highest to lowest):
# 1. Environment variables (HERMES_*)
# 2. .env file (in api/ directory)
# 3. config.yaml file
# 4. Default values
#
# ⚠️  SECURITY: Never put secrets (API keys, passwords, tokens) in this file!
#    - For development: Use .env file (gitignored)
#    - For production: Use environment variables set by your deployment system

# ============================================================================
# Server Configuration
# ============================================================================
server:
  # Port for the HTTP server to listen on
  # Environment variable: HERMES_SERVER_PORT
  # Default: 8080
  port: 8080

  # Host address to bind the server to
  # Use "0.0.0.0" to listen on all interfaces
  # Use "127.0.0.1" for localhost only
  # Environment variable: HERMES_SERVER_HOST
  # Default: "0.0.0.0"
  host: "0.0.0.0"

  # Maximum duration for reading the entire request (including body)
  # Format: duration string (e.g., "30s", "1m", "1h")
  # Environment variable: HERMES_SERVER_READTIMEOUT
  # Default: 30s
  readtimeout: 30s

  # Maximum duration before timing out writes of the response
  # Environment variable: HERMES_SERVER_WRITETIMEOUT
  # Default: 30s
  writetimeout: 30s

# ============================================================================
# Database Configuration
# ============================================================================
database:
  # Path to the SQLite database file
  # The directory will be created if it doesn't exist
  # Environment variable: HERMES_DATABASE_PATH
  # Default: "./data/hermes.db"
  path: "./data/hermes.db"

  # Enable Write-Ahead Logging (WAL) mode for better concurrency
  # Recommended: true for production
  # Environment variable: HERMES_DATABASE_ENABLEWAL
  # Default: true
  enablewal: true

  # Connection timeout (optional, not yet implemented)
  # Environment variable: HERMES_DATABASE_CONNECTIONTIMEOUT
  # connectiontimeout: 5s

# ============================================================================
# Logging Configuration
# ============================================================================
logging:
  # Log level: debug, info, warn, error
  # - debug: Detailed diagnostic information
  # - info: General informational messages
  # - warn: Warning messages
  # - error: Error messages only
  # Environment variable: HERMES_LOGGING_LEVEL
  # Default: "info"
  level: "info"

  # Pretty print logs for human readability
  # true: Console-friendly colored output (recommended for development)
  # false: JSON structured logs (recommended for production)
  # Environment variable: HERMES_LOGGING_PRETTY
  # Default: false
  pretty: false

# ============================================================================
# Media Configuration
# ============================================================================
media:
  # Path to the root directory containing media files
  # This will be scanned for video files to populate the media library
  # Environment variable: HERMES_MEDIA_LIBRARYPATH
  # Required: Must be set before media scanning features are used
  # librarypath: "/path/to/media/library"

  # Supported video file formats
  # Environment variable: HERMES_MEDIA_SUPPORTEDFORMATS (comma-separated)
  # Default: ["mp4", "mkv", "avi", "mov"]
  supportedformats:
    - mp4
    - mkv
    - avi
    - mov

# ============================================================================
# Streaming Configuration
# ============================================================================
streaming:
  # Hardware acceleration method for video encoding
  # Options: none, nvenc, qsv, vaapi, videotoolbox, auto
  # - none: Software encoding (always available, CPU-intensive)
  # - nvenc: NVIDIA GPU encoding (requires NVIDIA GPU + drivers)
  # - qsv: Intel Quick Sync Video (requires Intel CPU with iGPU)
  # - vaapi: Video Acceleration API (AMD/Intel on Linux)
  # - videotoolbox: Apple hardware encoding (macOS only)
  # - auto: Automatically detect and use best available
  # Environment variable: HERMES_STREAMING_HARDWAREACCEL
  # Default: "auto"
  hardwareaccel: "auto"
  
  # HLS segment duration in seconds
  # Shorter segments = lower latency but more overhead
  # Longer segments = higher latency but better efficiency
  # Recommended: 6 seconds (balance between latency and efficiency)
  # Environment variable: HERMES_STREAMING_SEGMENTDURATION
  # Default: 6
  segmentduration: 6
  
  # Number of segments to keep in HLS playlist
  # This affects the total buffer duration available to clients
  # Total buffer = segmentduration * playlistsize
  # With defaults: 6 seconds * 10 segments = 60 seconds buffer
  # Environment variable: HERMES_STREAMING_PLAYLISTSIZE
  # Default: 10
  playlistsize: 10
  
  # Directory for storing HLS stream segments
  # Segments are automatically cleaned up after use
  # Ensure sufficient disk space (minimum 5GB recommended)
  # Environment variable: HERMES_STREAMING_SEGMENTPATH
  # Default: "./data/streams"
  segmentpath: "./data/streams"
  
  # Grace period in seconds to keep stream alive after last client disconnects
  # This allows quick reconnections without restarting the transcode process
  # Setting to 0 stops streams immediately when last client disconnects
  # Environment variable: HERMES_STREAMING_GRACEPERIODSECONDS
  # Default: 30
  graceperiodseconds: 30
  
  # How often to cleanup old segments in seconds
  # Background task that removes orphaned segment files
  # Lower values = more frequent cleanup but more overhead
  # Higher values = less overhead but segments linger longer
  # Environment variable: HERMES_STREAMING_CLEANUPINTERVAL
  # Default: 60
  cleanupinterval: 60

# ============================================================================
# Example Configurations
# ============================================================================

# Development Configuration:
# - Enable debug logging
# - Use pretty console output
# - Bind to localhost only
#
# server:
#   port: 8080
#   host: "127.0.0.1"
# logging:
#   level: "debug"
#   pretty: true
# database:
#   path: "./data/hermes-dev.db"

# Production Configuration:
# - Use info level logging
# - JSON structured logs
# - Listen on all interfaces
# - Use environment variables for sensitive values
#
# server:
#   port: 8080
#   host: "0.0.0.0"
# logging:
#   level: "info"
#   pretty: false
# database:
#   path: "/var/lib/hermes/hermes.db"

