# [10-5] Now Playing Component (Mock Data)

[Back to task list](./tasks.md)

## Description

Display current program information with mock/placeholder data. This component shows the program title, episode info, description, thumbnail, progress bar, and time remaining. The data structure matches the EPG API shape from PBI-5 PRD to enable easy integration later.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-31 00:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

### Functional Requirements
- Display program title (show name + episode)
- Display episode description
- Display program thumbnail/poster
- Show progress bar (elapsed vs total duration)
- Display time remaining
- Use mock data that matches EPG API structure
- Retro styling consistent with app theme

### Technical Requirements
- Create `web/components/video/now-playing.tsx`
- Mock data structure matches PBI-5 EPG Program model
- Add clear TODO comment for EPG integration
- Use existing UI components (Card, Progress, etc.)
- Responsive layout

## Implementation Plan

### Step 1: Define mock data structure
```typescript
// TODO: Replace with EPG API when PBI-5 is complete
interface EPGProgram {
  channel_id: string;
  media_id: string;
  title: string;
  description: string;
  start_time: string; // ISO 8601
  end_time: string; // ISO 8601
  season?: number;
  episode?: number;
  icon?: string;
}

const mockProgram: EPGProgram = {
  channel_id: "...",
  media_id: "...",
  title: "Friends - The One Where...",
  description: "Ross and Rachel...",
  start_time: new Date().toISOString(),
  end_time: new Date(Date.now() + 30 * 60 * 1000).toISOString(),
  season: 1,
  episode: 1,
  icon: "/placeholder-thumbnail.jpg"
};
```

### Step 2: Create component structure
```
web/components/video/now-playing.tsx
```

### Step 3: Implement UI layout
- Thumbnail on left (or top on mobile)
- Program info on right
- Progress bar below info
- Time remaining display

### Step 4: Implement progress calculation
```typescript
const calculateProgress = (start: string, end: string) => {
  const now = Date.now();
  const startTime = new Date(start).getTime();
  const endTime = new Date(end).getTime();
  const total = endTime - startTime;
  const elapsed = now - startTime;
  return (elapsed / total) * 100;
};
```

### Step 5: Format time remaining
```typescript
const formatTimeRemaining = (end: string) => {
  const remaining = new Date(end).getTime() - Date.now();
  const minutes = Math.floor(remaining / 60000);
  return `${minutes} min remaining`;
};
```

### Step 6: Add retro styling
- Border and shadow effects
- VCR font for title
- Color scheme matching app

## Test Plan

### Objective
Verify the Now Playing component displays program information correctly with mock data.

### Test Scope
- Mock data display
- Progress bar calculation
- Time remaining calculation
- Responsive layout
- Retro styling

### Success Criteria
- Program title displays correctly
- Description shows
- Progress bar animates smoothly
- Time remaining updates
- Layout responsive on all screen sizes
- Mock data structure matches EPG API shape

## Verification

### Acceptance Criteria
- [ ] Component created at `web/components/video/now-playing.tsx`
- [ ] Mock data structure matches EPG Program from PBI-5 PRD
- [ ] Program title displayed
- [ ] Episode info displayed (season/episode if available)
- [ ] Description displayed
- [ ] Thumbnail displayed
- [ ] Progress bar shows elapsed vs total
- [ ] Time remaining calculated and displayed
- [ ] TODO comment added for EPG integration
- [ ] Retro styling applied
- [ ] Responsive layout works
- [ ] No console errors

### Definition of Done
- All acceptance criteria met
- Component renders with mock data
- Ready for EPG API integration
- Styling matches app theme

## Files Modified

### New Files Created
- `web/components/video/now-playing.tsx` - Now Playing component

### Modified Files
- `web/components/video/index.ts` - Add export

### API Specifications Updated
- `docs/api-specs/frontend/frontend-api.md` - Document NowPlaying component

## Notes

- Mock data should simulate realistic program information
- Progress bar should update every second
- Consider adding live badge for current programs
- Thumbnail fallback for missing images
- EPG API will provide real data in PBI-5
- Format: `show_name - episode_title` or `show_name S01E01`
- Description should truncate if too long (3-4 lines max)


