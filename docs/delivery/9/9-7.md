# [9-7] Add Alternative Table View

[Back to task list](./tasks.md)

## Description

Add an optional table view as an alternative to the tree view for users who prefer a traditional data table format for browsing their media library. This view displays all media items in a sortable table with columns for key metadata, providing a dense information display suitable for users familiar with spreadsheet-like interfaces.

**Priority: LOW** - This is an optional enhancement. Tree view (9-1) is the primary interface.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-28 00:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

### Functional Requirements

- View toggle button on library page (Tree / Table / Grid)
- Table displays all media items in flat list
- Columns:
  - Thumbnail (small preview image or placeholder)
  - Title
  - Show Name
  - Season
  - Episode
  - Duration (formatted)
  - Resolution
  - Codec (video)
  - Actions (Edit, Delete buttons)
- Sortable columns:
  - Click column header to sort ascending
  - Click again to sort descending
  - Visual indicator (arrow) for sort direction
  - Default sort: Show Name (A-Z), then Season, then Episode
- Row click opens detail modal (9-5)
- Action buttons trigger edit/delete without opening detail first
- Pagination or infinite scroll for large datasets
- Empty state when no media
- Loading skeleton during data fetch
- Responsive: fewer columns on mobile/tablet

### Technical Requirements

- Component at `web/components/media/media-table.tsx`
- Use @tanstack/react-table or native table with sort logic
- Accept filtered media data as prop
- Emit events: onRowClick, onEdit, onDelete
- Virtual scrolling or pagination for performance (1000+ items)
- Follow design system: heavy border (border-4), retro styling
- Table container with shadow
- Responsive column visibility
- Accessible (sortable headers announced, keyboard navigation)

### Table Layout

```typescript
interface MediaTableProps {
  media: Media[];
  onRowClick: (media: Media) => void;
  onEdit: (media: Media) => void;
  onDelete: (media: Media) => void;
}

// Column definitions
- Thumbnail: 80px fixed width, aspect-square
- Title: flex, min-width 200px
- Show: flex, min-width 150px
- Season: 80px fixed
- Episode: 80px fixed
- Duration: 100px fixed
- Resolution: 120px fixed
- Codec: 100px fixed
- Actions: 120px fixed
```

## Implementation Plan

### Step 1: Create Table Component Structure
- Create `web/components/media/media-table.tsx`
- Set up table container with retro styling
- Define column configuration
- Set up responsive column visibility

### Step 2: Implement Sorting Logic
- Add sort state (column, direction)
- Implement sort functions for each column type
- Apply sort to media data
- Add sort indicators to column headers
- Handle column header clicks

### Step 3: Build Table Header
- Render header row with column names
- Make headers clickable for sorting
- Show sort direction arrows (up/down)
- Apply heavy border (border-b-4) below header
- Use VCR text for column names
- Add hover effects

### Step 4: Build Table Rows
- Map filtered media to table rows
- Display data in appropriate columns
- Format values (duration, resolution)
- Add hover effect on rows
- Make rows clickable (opens detail modal)
- Handle row click event

### Step 5: Add Action Buttons
- "Edit" button in actions column (accent color)
- "Delete" button in actions column (destructive color)
- Buttons stop propagation (don't trigger row click)
- Retro button styling (smaller size)
- Icon + text or icon only (based on space)

### Step 6: Implement Responsive Behavior
- Desktop: all columns visible
- Tablet: hide Codec, Resolution
- Mobile: show only Thumbnail, Title, Actions
- Use CSS media queries or responsive utilities
- Ensure table scrollable horizontally on mobile if needed

### Step 7: Add Pagination or Virtual Scrolling
- If using pagination:
  - Page size controls (20, 50, 100)
  - Previous/Next buttons
  - Page number display
- If using virtual scrolling:
  - Implement with @tanstack/react-virtual
  - Render only visible rows
  - Maintain scroll position

### Step 8: Integrate with Library Page
- Update `web/app/library/page.tsx`
- Add view toggle buttons (Tree / Table / Grid)
- Show MediaTable when table view selected
- Pass filtered media data
- Connect row click to detail modal
- Connect edit/delete to handlers

### Step 9: Polish and Accessibility
- Loading skeleton matching table structure
- Empty state in table format
- Keyboard navigation (arrow keys between rows)
- ARIA labels for sortable headers
- ARIA sort attribute (ascending/descending/none)
- Focus visible on keyboard navigation
- Screen reader announces sort changes

## Test Plan

### Objective
Verify the table view provides an efficient alternative interface for viewing and managing media with sorting and responsive behavior.

### Test Scope
- Table rendering
- Sorting functionality
- Row interactions
- Action buttons
- Responsive behavior
- Performance
- Accessibility

### Key Test Scenarios

#### Table Rendering
- Table displays all media items
- All columns render correctly
- Data formatted properly
- Table container has heavy border and shadow
- Header has VCR text styling

#### Sorting Functionality
- Default sort: Show Name, Season, Episode
- Click header: sorts ascending
- Click again: sorts descending
- Click third time: removes sort (back to default)
- Sort indicator shows correct direction
- Multiple sort clicks work smoothly
- Sort state persists during re-renders

#### Row Interactions
- Click row opens detail modal
- Correct media passed to modal
- Row hover effect works
- Multiple row clicks work

#### Action Buttons
- "Edit" button triggers edit handler
- "Delete" button triggers delete handler
- Buttons don't trigger row click
- Button styling correct (accent/destructive)
- Hover effects work

#### Responsive Behavior
- Desktop: all columns visible
- Tablet: codec and resolution hidden
- Mobile: only thumbnail, title, actions
- Table readable on all screen sizes
- Horizontal scroll if needed on mobile

#### Performance
- 1000+ items render without lag
- Sort operations fast
- Virtual scrolling/pagination works
- No memory leaks

#### Accessibility
- Table has proper semantic structure
- Headers have ARIA sort attributes
- Keyboard navigation works (tab, arrows)
- Focus visible
- Screen reader announces sorts
- Action buttons accessible

### Success Criteria
- Table provides efficient alternative to tree view
- Sorting works smoothly for all columns
- Responsive on all device sizes
- Performance acceptable with large datasets
- Follows design system standards
- Accessible to keyboard and screen reader users

## Verification

- [ ] MediaTable component created
- [ ] Table container styled with border-4, heavy shadow
- [ ] All columns defined and displayed
- [ ] Column headers clickable for sorting
- [ ] Sort indicators show direction
- [ ] Sorting logic works for all columns
- [ ] Default sort applied (Show, Season, Episode)
- [ ] Row click opens detail modal
- [ ] "Edit" button triggers edit handler
- [ ] "Delete" button triggers delete handler
- [ ] Action buttons don't trigger row click
- [ ] Responsive column visibility works
- [ ] Pagination or virtual scrolling implemented
- [ ] Loading skeleton for table
- [ ] Empty state when no media
- [ ] View toggle integrated in library page (9-4)
- [ ] Table view switchable from tree view
- [ ] Follows design system standards
- [ ] Accessible (ARIA, keyboard nav)
- [ ] Performance acceptable with 1000+ items

## Files Modified

### New Files
- `web/components/media/media-table.tsx` - Media table component

### Modified Files
- `web/app/library/page.tsx` - Add view toggle and table view option

### Dependencies
- @tanstack/react-table (optional, for advanced table features)
- @tanstack/react-virtual (optional, for virtual scrolling)
- Existing: @/lib/types/api (Media type)
- Existing: @/components/ui/button (Button component)
- Existing: @/components/ui/table (Table components)
- Existing: lucide-react (icons)
- Integration with task 9-4 (library page)
- Integration with task 9-5 (detail modal)

