# [1-2] Add Core Dependencies

[Back to task list](./tasks.md)

## Description

Add all core Go dependencies required for the Virtual TV Channel Service backend. This includes the web framework (Gin), database driver (SQLite), configuration management (Viper), logging (zerolog), database migrations (golang-migrate), and UUID generation (google/uuid).

This task establishes the dependency foundation, ensuring all required packages are available for subsequent implementation tasks.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-26 12:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2025-10-27 21:37:00 | Status Change | Proposed | Agreed | Task approved for implementation | User |
| 2025-10-27 21:37:00 | Status Change | Agreed | InProgress | Started adding dependencies | AI_Agent |
| 2025-10-27 21:37:00 | Status Change | InProgress | Review | All dependencies added and verified | AI_Agent |
| 2025-10-27 21:40:00 | Status Change | Review | Done | Task completed successfully, all dependencies added and verified | User |

## Requirements

### Functional Requirements
- Add all required Go packages to go.mod
- Ensure packages are at their latest stable versions
- Verify all packages download successfully
- Ensure no dependency conflicts exist

### Required Dependencies
1. **Gin Framework** (`github.com/gin-gonic/gin`)
   - Purpose: HTTP routing and middleware
   - Latest stable version

2. **SQLite Driver** (`github.com/mattn/go-sqlite3`)
   - Purpose: SQLite database connectivity
   - Requires CGO enabled

3. **Viper** (`github.com/spf13/viper`)
   - Purpose: Configuration management
   - Supports multiple config formats

4. **zerolog** (`github.com/rs/zerolog`)
   - Purpose: Fast, structured JSON logging
   - Zero-allocation design

5. **golang-migrate** (`github.com/golang-migrate/migrate/v4`)
   - Purpose: Database schema migrations
   - Need both library and SQLite driver

6. **UUID** (`github.com/google/uuid`)
   - Purpose: UUID generation for entity IDs
   - Standard UUID v4 implementation

### Technical Requirements
- All packages must be compatible with Go 1.25+
- CGO must be enabled for SQLite support
- All dependencies must resolve without conflicts
- go.sum file must be generated correctly

## Implementation Plan

### Step 1: Add Gin Framework
```bash
go get -u github.com/gin-gonic/gin@latest
```

### Step 2: Add SQLite Driver
```bash
go get -u github.com/mattn/go-sqlite3@latest
```
Note: Requires CGO_ENABLED=1 for compilation

### Step 3: Add Viper Configuration
```bash
go get -u github.com/spf13/viper@latest
```

### Step 4: Add zerolog Logging
```bash
go get -u github.com/rs/zerolog@latest
```

### Step 5: Add golang-migrate
```bash
go get -u github.com/golang-migrate/migrate/v4@latest
go get -u github.com/golang-migrate/migrate/v4/database/sqlite3@latest
go get -u github.com/golang-migrate/migrate/v4/source/file@latest
```

### Step 6: Add UUID Package
```bash
go get -u github.com/google/uuid@latest
```

### Step 7: Tidy Dependencies
```bash
go mod tidy
```

### Step 8: Verify Dependencies
- Check go.mod contains all packages
- Check go.sum is properly generated
- Attempt a build to verify no issues

## Test Plan

This task involves adding dependencies with straightforward verification.

### Success Criteria
1. All 6 core dependencies listed in go.mod
2. go.sum file generated with checksums
3. No dependency resolution errors
4. `go mod tidy` runs without errors
5. `go build ./cmd/server` succeeds (even though packages aren't used yet)

### Verification Commands
```bash
# Verify all dependencies present
grep "github.com/gin-gonic/gin" go.mod
grep "github.com/mattn/go-sqlite3" go.mod
grep "github.com/spf13/viper" go.mod
grep "github.com/rs/zerolog" go.mod
grep "github.com/golang-migrate/migrate" go.mod
grep "github.com/google/uuid" go.mod

# Verify no dependency issues
go mod verify

# Verify project still builds
go build ./cmd/server
```

## Verification

### Acceptance Criteria
- [x] Gin framework added to go.mod (v1.11.0)
- [x] SQLite driver added to go.mod (v1.14.32)
- [x] Viper configuration library added to go.mod (v1.21.0)
- [x] zerolog logging library added to go.mod (v1.34.0)
- [x] golang-migrate with SQLite support added to go.mod (v4.19.0)
- [x] google/uuid package added to go.mod (v1.6.0)
- [x] go.sum file generated correctly (143 lines)
- [x] `go mod verify` passes (all modules verified)
- [x] `go mod tidy` runs without errors
- [x] Project still builds successfully (19MB binary created)

### Definition of Done
- All acceptance criteria met
- No dependency conflicts or resolution errors
- go.sum file committed to version control
- Dependencies documented in go.mod

## Files Modified

### Modified Files
- `go.mod` - Updated with all required dependencies
- `go.sum` - Generated with dependency checksums

### New Files Created
- None (modifications only)

## Notes

- CGO must be enabled for SQLite support (CGO_ENABLED=1)
- Some packages may pull in transitive dependencies
- Versions should be latest stable at time of implementation
- go.sum should be committed to version control for reproducible builds
- Unused imports in main.go are acceptable at this stage - they'll be used in subsequent tasks

## Implementation Notes

### Dependencies Added
All 6 core dependencies successfully added with latest stable versions:
1. Gin v1.11.0 - HTTP web framework
2. SQLite v1.14.32 - Database driver (requires CGO)
3. Viper v1.21.0 - Configuration management
4. zerolog v1.34.0 - Structured JSON logging
5. golang-migrate v4.19.0 - Database migrations (including sqlite3 and file drivers)
6. google/uuid v1.6.0 - UUID generation

### Blank Imports Strategy
Added blank imports to `cmd/server/main.go` to preserve dependencies in go.mod until they're actively used in subsequent tasks. Each import is documented with the task number where it will be utilized.

### Verification Results
- `go mod verify`: All modules verified successfully
- `go build ./cmd/server`: Compiled successfully (19MB binary)
- `./server`: Runs without errors
- go.sum: Generated with 143 checksum entries
- No dependency conflicts detected

