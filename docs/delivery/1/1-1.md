# [1-1] Initialize Go Project Structure

[Back to task list](./tasks.md)

## Description

Create the foundational Go project structure following best practices for a web service application. This includes setting up the directory hierarchy, initializing the Go module with Go 1.25+, creating the main entry point, and configuring version control exclusions.

This task establishes the organizational framework that all subsequent development will build upon, ensuring a clean separation of concerns between API handlers, business logic, data access, and infrastructure code.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-26 12:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2025-10-27 21:12:00 | Status Change | Proposed | Agreed | Task approved for implementation | User |
| 2025-10-27 21:13:00 | Status Change | Agreed | InProgress | Started implementation | AI_Agent |
| 2025-10-27 21:20:00 | Status Change | InProgress | Review | Implementation completed, ready for review | AI_Agent |
| 2025-10-27 21:22:00 | Significant Update | Review | InProgress | Restructured to monorepo (api/ and web/ directories) per user request | AI_Agent |
| 2025-10-27 21:25:00 | Status Change | InProgress | Review | Monorepo restructure completed, all functionality verified | AI_Agent |
| 2025-10-27 21:28:00 | Minor Update | Review | Review | Fixed Air config: moved .air.toml into api/ directory, updated root="." | AI_Agent |
| 2025-10-27 21:30:00 | Status Change | Review | Done | Task approved and completed successfully | User |

## Requirements

### Functional Requirements
- Create standard Go project directory structure (cmd/, internal/, pkg/, migrations/)
- Initialize go.mod with Go version 1.25
- Create main.go entry point in cmd/server/
- Add .gitignore file with appropriate exclusions for Go projects
- Ensure the project can be built with `go build`

### Technical Requirements
- Go 1.25+ must be installed on the system
- Project module name: `github.com/username/hermes` (or appropriate module path)
- Directory structure must follow Go community conventions
- Must support building a single binary from cmd/server/main.go

### Directory Structure to Create

**Note**: This project uses a monorepo structure with separate `api/` (Go backend) and `web/` (Next.js frontend) directories.

```
hermes/
├── api/                      # Go backend service
│   ├── cmd/
│   │   └── server/
│   │       └── main.go       # Application entry point
│   ├── internal/
│   │   ├── api/              # HTTP handlers (to be populated in later tasks)
│   │   ├── models/           # Data models (to be populated in later tasks)
│   │   ├── db/               # Database operations (to be populated in later tasks)
│   │   ├── config/           # Configuration management (to be populated in later tasks)
│   │   └── middleware/       # HTTP middleware (to be populated in later tasks)
│   ├── migrations/           # Database migration files (to be populated in later tasks)
│   ├── pkg/                  # Public packages (if needed)
│   ├── go.mod                # Go module definition
│   ├── go.sum                # Dependency checksums (generated)
│   └── README.md             # API documentation
├── web/                      # Next.js frontend (to be added in PBI-7)
│   └── README.md             # Web client documentation
├── docs/                     # Project documentation
├── .air.toml                 # Hot reload configuration
├── .gitignore                # Git exclusions
└── README.md                 # Project documentation
```

## Implementation Plan

### Step 1: Verify Go Version
- Check that Go 1.25+ is installed using `go version`
- If not installed, document the installation requirement

### Step 2: Create Directory Structure
- Create monorepo directories: api/, web/
- Create Go backend directories: api/cmd/server/, api/internal/{api,models,db,config,middleware}/, api/migrations/, api/pkg/
- Use `mkdir -p` to create nested directories

### Step 3: Initialize Go Module
- Run `go mod init github.com/stwalsh4118/hermes` in the api/ directory
- Verify go.mod file is created with correct Go version directive

### Step 4: Create Main Entry Point
- Create api/cmd/server/main.go with minimal functional code:
  - Package main declaration
  - Main function that prints a startup message
  - Placeholder for future server initialization

### Step 5: Create .gitignore
- Add exclusions for both Go backend and future Node.js frontend:
  - Compiled binaries (api/server)
  - Test coverage files
  - IDE/editor specific files
  - OS-specific files
  - Database files (*.db)
  - Log files (*.log)
  - Node.js dependencies (web/node_modules/)
  - Next.js build artifacts (web/.next/, web/out/)
  - Air temp files (api/tmp/)

### Step 6: Create Initial READMEs
- Root README.md: Document monorepo structure and overall project
- api/README.md: Go backend specific documentation
- web/README.md: Frontend placeholder documentation
- List prerequisites (Go 1.25+, SQLite3)
- Basic build instructions for both services
- Placeholder sections for configuration and deployment

### Step 7: Verify Build
- Run `go build ./cmd/server` from api/ directory to ensure project compiles
- Run the compiled binary to verify it executes
- Verify Air hot reload configuration points to correct paths

## Test Plan

This is a foundational setup task with straightforward verification requirements.

### Success Criteria
1. All directories exist as specified
2. `go.mod` file contains `go 1.25` directive
3. `cmd/server/main.go` exists and contains valid Go code
4. `.gitignore` file exists with appropriate exclusions
5. `go build ./cmd/server` executes without errors
6. Compiled binary runs without crashing
7. `README.md` exists with basic project information

### Manual Verification Steps
```bash
# Verify monorepo directory structure
tree -L 2 api/ web/

# Verify Go module
cat api/go.mod | grep "go 1.25"

# Verify build
cd api
go build ./cmd/server
./server  # Should print startup message and exit cleanly

# Verify git exclusions
cat .gitignore | grep "api/tmp"
cat .gitignore | grep "web/node_modules"

# Verify Air configuration
cat api/.air.toml | grep 'root = "."'
```

## Verification

### Acceptance Criteria
- [x] Monorepo directory structure created (api/, web/)
- [x] Go backend directory structure created as specified
- [x] api/go.mod initialized with Go 1.25.1 and github.com/stwalsh4118/hermes
- [x] api/cmd/server/main.go created with package main and main() function
- [x] .gitignore file contains all necessary exclusions (Go + Node.js)
- [x] README.md files exist (root, api/, web/)
- [x] `go build ./cmd/server` succeeds from api/ directory
- [x] Compiled binary executes and prints startup message
- [x] Air hot reload configuration (.air.toml) located in api/ directory

### Definition of Done
- All acceptance criteria met
- Project structure follows Go best practices
- Code compiles without errors or warnings
- README documents the project purpose and setup steps

## Files Modified

### New Files Created
- `api/go.mod` - Go module definition with github.com/stwalsh4118/hermes
- `api/cmd/server/main.go` - Application entry point with startup message
- `api/README.md` - Backend API documentation
- `web/README.md` - Frontend placeholder documentation
- `.gitignore` - Version control exclusions for both Go and Node.js (root level)
- `api/.air.toml` - Air hot reload configuration for development (inside api/ directory)
- `README.md` - Root project documentation explaining monorepo structure
- All directory structure as specified above (api/, web/, and subdirectories)

### Files Modified
- `README.md` - Updated from minimal placeholder to comprehensive monorepo documentation

## Notes

- This task does NOT include adding dependencies - that's handled in task 1-2
- The main.go file at this stage is just a placeholder that can be built
- Actual server functionality will be added in later tasks
- Module path configured as github.com/stwalsh4118/hermes
- Air hot reload configuration added for development workflow (user request)
- **Monorepo Structure**: Project restructured to support both Go backend (api/) and Next.js frontend (web/) in a single repository (user request)
- Air configuration (.air.toml) placed in api/ directory and configured to run from there
- .gitignore updated to handle both Go and Node.js artifacts

