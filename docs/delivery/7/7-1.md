# [7-1] Initialize Next.js 15 project with pnpm and TypeScript

[Back to task list](./tasks.md)

## Description

Initialize a new Next.js 15.5 project in the `web/` directory using pnpm as the package manager. Configure the project with TypeScript, App Router, and essential dependencies for React 19.1.1. This task establishes the frontend foundation that all subsequent tasks will build upon.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-27 14:00:00 | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

### Functional Requirements
- Initialize Next.js 15.5 project with App Router in `web/` directory
- Configure TypeScript with strict mode
- Use pnpm as package manager
- Install React 19.1.1 and React DOM 19.1.1
- Create basic project structure with app directory
- Configure ESLint and Prettier
- Create initial root layout and page

### Technical Requirements
- Node.js 20+ must be installed
- pnpm must be installed globally
- Next.js version: 15.5
- React version: 19.1.1
- TypeScript strict mode enabled
- App Router (not Pages Router)

### Success Criteria
- Project initializes without errors
- `pnpm dev` starts development server successfully
- `pnpm build` completes without errors
- TypeScript compilation works correctly
- ESLint runs without errors on initial code

## Implementation Plan

### Step 1: Verify Prerequisites
- Check Node.js version (should be 20+)
- Check pnpm is installed: `pnpm --version`
- If pnpm not installed: `npm install -g pnpm`

### Step 2: Initialize Next.js Project
```bash
cd web
pnpm create next-app@15.5 . --typescript --app --eslint --tailwind --no-src-dir
```

Options explained:
- `--typescript`: Enable TypeScript
- `--app`: Use App Router (not Pages Router)
- `--eslint`: Include ESLint configuration
- `--tailwind`: Include Tailwind CSS (will be configured in task 7-2)
- `--no-src-dir`: Place app/ at root level (not in src/)

### Step 3: Install Specific React Versions
```bash
cd web
pnpm add react@19.1.1 react-dom@19.1.1
```

### Step 4: Configure TypeScript
Update `tsconfig.json` to ensure strict mode:
```json
{
  "compilerOptions": {
    "strict": true,
    "noUncheckedIndexedAccess": true,
    "noImplicitOverride": true
  }
}
```

### Step 5: Configure Prettier
Create `.prettierrc`:
```json
{
  "semi": true,
  "trailingComma": "es5",
  "singleQuote": false,
  "tabWidth": 2,
  "useTabs": false,
  "printWidth": 100
}
```

Create `.prettierignore`:
```
.next
node_modules
pnpm-lock.yaml
public
```

Install Prettier:
```bash
pnpm add -D prettier prettier-plugin-tailwindcss
```

### Step 6: Update ESLint Config
Update `.eslintrc.json` to include recommended rules:
```json
{
  "extends": [
    "next/core-web-vitals",
    "next/typescript"
  ],
  "rules": {
    "@typescript-eslint/no-unused-vars": ["error", { "argsIgnorePattern": "^_" }],
    "@typescript-eslint/no-explicit-any": "warn"
  }
}
```

### Step 7: Add Package Scripts
Update `package.json` scripts:
```json
{
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "format": "prettier --write .",
    "type-check": "tsc --noEmit"
  }
}
```

### Step 8: Create Basic Directory Structure
Create placeholder directories:
```bash
mkdir -p web/app/channels web/app/library web/app/settings
mkdir -p web/components/ui web/components/layout web/components/common
mkdir -p web/lib web/hooks
```

### Step 9: Create Root Layout
Update `app/layout.tsx` with proper metadata and structure:
```typescript
import type { Metadata } from "next";
import "./globals.css";

export const metadata: Metadata = {
  title: "Hermes - Virtual TV Channel Service",
  description: "Manage and stream your own virtual TV channels",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en" suppressHydrationWarning>
      <body>{children}</body>
    </html>
  );
}
```

### Step 10: Create Basic Home Page
Update `app/page.tsx`:
```typescript
export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-24">
      <h1 className="text-4xl font-bold">Hermes</h1>
      <p className="mt-4 text-lg text-gray-600">Virtual TV Channel Service</p>
    </main>
  );
}
```

### Step 11: Verify Build
```bash
cd web
pnpm run type-check
pnpm run lint
pnpm run build
```

## Test Plan

### Manual Testing
1. **Project Initialization**
   - Verify `web/package.json` exists with correct dependencies
   - Check React version is 19.1.1
   - Check Next.js version is 15.5

2. **Development Server**
   - Run `pnpm dev`
   - Open http://localhost:3000
   - Verify home page displays correctly
   - Check console for errors

3. **Build Process**
   - Run `pnpm build`
   - Verify build completes successfully
   - Check `.next` directory is created

4. **TypeScript**
   - Run `pnpm type-check`
   - Verify no type errors

5. **Linting**
   - Run `pnpm lint`
   - Verify no linting errors

### Success Criteria
- All commands execute without errors
- Development server starts and displays home page
- Production build completes successfully
- TypeScript compilation passes
- ESLint passes with no errors

## Verification

### Acceptance Criteria
- [ ] Next.js 15.5 project created in `web/` directory
- [ ] React 19.1.1 and React DOM 19.1.1 installed
- [ ] pnpm configured as package manager
- [ ] TypeScript strict mode enabled
- [ ] ESLint and Prettier configured
- [ ] Basic directory structure created
- [ ] Root layout and home page functional
- [ ] `pnpm dev` starts development server
- [ ] `pnpm build` completes successfully
- [ ] `pnpm type-check` passes
- [ ] `pnpm lint` passes
- [ ] Project uses App Router (not Pages Router)

### Definition of Done
- All acceptance criteria met
- No console errors in development mode
- Build process completes without warnings or errors
- Code follows TypeScript strict mode requirements
- Project structure follows Next.js 15 best practices

## Files Modified

### New Files Created
- `web/package.json` - Package dependencies and scripts
- `web/pnpm-lock.yaml` - Dependency lock file
- `web/tsconfig.json` - TypeScript configuration
- `web/.eslintrc.json` - ESLint configuration
- `web/.prettierrc` - Prettier configuration
- `web/.prettierignore` - Prettier ignore patterns
- `web/next.config.js` - Next.js configuration
- `web/tailwind.config.ts` - Tailwind configuration (basic, will be customized in 7-2)
- `web/postcss.config.js` - PostCSS configuration
- `web/app/layout.tsx` - Root layout component
- `web/app/page.tsx` - Home page component
- `web/app/globals.css` - Global styles
- `web/public/` - Static assets directory
- `web/.gitignore` - Git ignore patterns for frontend

### Directories Created
- `web/app/channels/` - Channels pages directory
- `web/app/library/` - Library pages directory
- `web/app/settings/` - Settings pages directory
- `web/components/ui/` - shadcn/ui components (to be populated)
- `web/components/layout/` - Layout components
- `web/components/common/` - Common components
- `web/lib/` - Utility libraries
- `web/hooks/` - Custom React hooks

## Notes

- This task creates the foundation but does NOT include shadcn/ui setup (that's task 7-3)
- Dark mode configuration will be added in task 7-2
- TanStack Query and Zustand will be added in tasks 7-4 and 7-5
- The project uses App Router, which is the recommended approach for Next.js 15
- Tailwind is included but will be fully configured with dark mode in task 7-2

