# [12-8] Remove legacy realtime pacing mode

[Back to task list](./tasks.md)

## Description

Remove the legacy real-time pacing mode (`-re` flag) and continuous stream monitoring code that is no longer needed with batch-based generation. Remove RealtimePacing config option, remove `-re` flag logic from FFmpeg command builder, and clean up any continuous monitoring code that was replaced by batch coordinator.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-01-XX XX:XX:XX | Created | N/A | Proposed | Task file created | AI_Agent |

## Requirements

### Functional Requirements
- Remove RealtimePacing field from StreamingConfig
- Remove RealtimePacing field from StreamParams
- Remove `-re` flag logic from buildInputArgs
- Remove continuous monitoring code (if any)
- Update config.yaml.example to remove realtime pacing option
- Ensure batch mode never uses real-time pacing (already enforced)

### Technical Requirements
- Modify `api/internal/config/config.go` - Remove RealtimePacing field
- Modify `api/internal/streaming/ffmpeg.go` - Remove `-re` flag logic
- Modify `api/config.yaml.example` - Remove realtime pacing documentation
- Search codebase for any references to RealtimePacing
- Remove any continuous stream monitoring code

## Implementation Plan

### Step 1: Remove RealtimePacing from config
- Remove RealtimePacing bool field from StreamingConfig
- Remove any defaults for realtime pacing
- Remove any validation for realtime pacing

### Step 2: Remove RealtimePacing from StreamParams
- Remove RealtimePacing bool field from StreamParams
- Update any code that sets this field

### Step 3: Remove `-re` flag logic
- Remove `-re` flag addition from buildInputArgs
- Remove any conditions checking RealtimePacing
- Ensure batch mode logic doesn't reference it

### Step 4: Search for references
- Use grep to find all references to RealtimePacing
- Remove or update any remaining references
- Ensure no broken code

### Step 5: Update documentation
- Remove realtime pacing from config.yaml.example
- Update API specs if needed
- Remove any comments about real-time mode

### Step 6: Remove continuous monitoring
- Review manager.go for continuous monitoring code
- Remove any code that was replaced by batch coordinator
- Ensure no orphaned goroutines or tickers

## Test Plan

### Objective
Verify legacy real-time pacing code is completely removed and batch mode works without it.

### Test Scope
- Config loading without RealtimePacing field
- FFmpeg command generation without `-re` flag
- Batch mode still works correctly
- No references to RealtimePacing remain
- No broken code or compilation errors

### Success Criteria
- RealtimePacing field removed from config
- `-re` flag never added to FFmpeg commands
- Batch mode works correctly
- No compilation errors
- No references to removed code

## Verification

### Acceptance Criteria
- [ ] RealtimePacing removed from StreamingConfig
- [ ] RealtimePacing removed from StreamParams
- [ ] `-re` flag logic removed from buildInputArgs
- [ ] Config.yaml.example updated
- [ ] No references to RealtimePacing remain
- [ ] Continuous monitoring code removed (if any)
- [ ] Batch mode works correctly
- [ ] Code compiles without errors
- [ ] All tests pass

### Definition of Done
- All acceptance criteria met
- Code compiles without errors
- All tests pass
- No dead code remaining
- Documentation updated
- Ready for frontend implementation

## Files Modified

### Modified Files
- `api/internal/config/config.go` - Remove RealtimePacing field
- `api/internal/streaming/ffmpeg.go` - Remove `-re` flag logic
- `api/config.yaml.example` - Remove realtime pacing option
- `api/internal/streaming/manager.go` - Remove continuous monitoring (if any)

### API Specifications Updated
- `docs/api-specs/streaming/streaming-api.md` - Remove realtime pacing documentation
- `docs/api-specs/infrastructure/infrastructure-api.md` - Remove realtime pacing config

## Notes

- Real-time pacing was the slow mode (1x speed encoding)
- Batch mode always uses fast encoding (no `-re` flag)
- This is a cleanup task removing unused code
- Ensure no breaking changes to existing functionality
- All batch mode logic should already be independent of realtime pacing

